(this["webpackJsonpreact-template"]=this["webpackJsonpreact-template"]||[]).push([[20],{215:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var c=n(75),i=function(e){return{type:c.a,payload:e}}},218:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return u}));var c=n(214),i=n(215),a=n(35),s=function(e){return{type:a.a,payload:e}},r=function(e){return{type:a.c,payload:e}},l=function(){return{type:a.b}},o=function(e){return{type:a.d,payload:e}},u=function(e,t){return function(n){c.a.homeApi.getPlaylistDetail({id:e}).then((function(e){if(200===e.data.code){var c,a=(null===(c=e.data.playlist)||void 0===c?void 0:c.tracks)||[];n(o(a)),a.length&&(n(Object(i.a)(a[0])),t&&t(a))}})).catch((function(){}))}}},286:function(e,t,n){"use strict";var c=n(0),i=n(8),a=n(327),s=n.n(a),r=n(9),l=function(e){var t=e.list;return Object(r.jsx)(r.Fragment,{children:null===t||void 0===t?void 0:t.map((function(n,i){var a=(null===n||void 0===n?void 0:n.userName)||(null===n||void 0===n?void 0:n.name),l=(null===n||void 0===n?void 0:n.userId)||(null===n||void 0===n?void 0:n.id);return Object(r.jsxs)(c.Fragment,{children:[Object(r.jsx)("span",{title:a,className:s.a.Authors,onClick:function(){var t;(t=l)&&e.history.push("/discover/artist-detail/".concat(t))},children:a},i),Object(r.jsx)("span",{children:i<=(null===t||void 0===t?void 0:t.length)-2?" / ":""})]},i)}))})};l.defaultProps={},t.a=Object(i.f)(Object(c.memo)(l))},327:function(e,t,n){e.exports={Authors:"Authors_Authors__3DmHW"}},551:function(e,t,n){e.exports={PlayBar:"PlayBar_PlayBar__1UJ2Q",container:"PlayBar_container__1vXZO",songListAndLyricWrapper:"PlayBar_songListAndLyricWrapper__3ULpg",songListAndLyric:"PlayBar_songListAndLyric__1GGdN","lyric-show-box":"PlayBar_lyric-show-box__2xos4","bg-l":"PlayBar_bg-l__Vw__p",miniLock:"PlayBar_miniLock__3Ssve",btn:"PlayBar_btn__1XzpM",lock:"PlayBar_lock__fxbdH",unlock:"PlayBar_unlock__FFOwT","bg-r":"PlayBar_bg-r__1wY_k"}},592:function(e,t,n){"use strict";n.r(t);n(285);var c=n(124),i=n.n(c),a=(n(276),n(238)),s=n.n(a),r=(n(547),n(555)),l=n.n(r),o=n(549),u=n.n(o),d=n(550),j=(n(217),n(70)),b=n.n(j),f=n(71),v=n(598),m=n(599),O=n(600),h=n(601),g=n(602),p=n(0),x=n(368),_=n(41),y=n(252),k=n.n(y),N=n(226),C=n(587),L=n(563),w=n(218),S=n(215),P=n(551),E=n.n(P),B=n(216),A=n(214),I=n(585),T=function(e,t,n,c){var i=Object(p.useState)(0),a=Object(f.a)(i,2),s=a[0],r=a[1],l=Object(p.useRef)({fn:Object(I.a)((function(e){e&&e()}),500)});return Object(p.useEffect)((function(){l.current.fn((function(){if(n.length){var t=n.findIndex((function(t){return t.totalTime>=1e3*e}));t>0&&t-1!==s&&r(t-1)}}))}),[e,t,n,s]),Object(p.useEffect)((function(){r(0)}),[c]),[s]},R=function(e,t){Object(p.useEffect)((function(){var n=function(n){e.current&&!e.current.contains(n.target)&&t()};return document.addEventListener("click",n),function(){document.removeEventListener("click",n)}}),[t,e])},F=n(8),M=n(286),U=n(9),K=["loop","shuffle","one"],V=function(e){var t,n,c,a,r=e.songList,o=e.currentSongInfo,j=e.playBarState,_=e.start_is_play,y=j.isPlay,w=Object(p.useState)(!0),S=Object(f.a)(w,2),P=S[0],B=S[1],I=Object(p.useState)(!1),F=Object(f.a)(I,2),V=F[0],W=F[1],D=Object(p.useState)("loop"),G=Object(f.a)(D,2),J=G[0],q=G[1],H=Object(p.useState)(!1),X=Object(f.a)(H,2),z=X[0],Q=X[1],Y=Object(p.useState)(!1),Z=Object(f.a)(Y,2),$=Z[0],ee=Z[1],te=Object(p.useState)(.3),ne=Object(f.a)(te,2),ce=ne[0],ie=ne[1],ae=Object(p.useState)(0),se=Object(f.a)(ae,2),re=se[0],le=se[1],oe=Object(p.useState)(0),ue=Object(f.a)(oe,2),de=ue[0],je=ue[1],be=Object(p.useState)([]),fe=Object(f.a)(be,2),ve=fe[0],me=fe[1],Oe=Object(p.useState)(),he=Object(f.a)(Oe,2),ge=he[0],pe=he[1],xe=Object(p.useRef)(null),_e=Object(p.useRef)(null),ye=Object(p.useRef)(null),ke=Object(p.useRef)(null),Ne=Object(p.useRef)({id:null}),Ce=Object(p.useRef)({id:null});Object(p.useEffect)((function(){var e,t;y?null===(e=xe.current)||void 0===e||e.play().then((function(e){})).catch((function(e){})):null===(t=xe.current)||void 0===t||t.pause()}),[y]),Object(p.useEffect)((function(){xe.current&&(xe.current.volume=ce)}),[ce]),Object(p.useEffect)((function(){me([]),A.a.homeApi.getLyric(o.id).then((function(e){if(200===e.data.code){var t,n=(null===(t=e.data.lrc)||void 0===t?void 0:t.lyric)||"",c=N.a.parseLyric(n);me(c||[])}})).catch((function(){}))}),[o.id]);var Le=Object(p.useCallback)((function(){if(r.length>1){var t=r.findIndex((function(e){return e.id===o.id}));if(0===t)e.change_current_song_info(r[r.length-1]);else{var n=r[t-1];e.change_current_song_info(n)}}}),[o.id,e,r]),we=Object(p.useCallback)((function(){setTimeout((function(){xe.current&&(xe.current.currentTime=0,_())}),50)}),[_]),Se=Object(p.useCallback)((function(){if(1===r.length)we();else if(r.length>1){var t=Object(C.a)(r.filter((function(e){return e.id!==o.id})));e.change_current_song_info(t),we()}else b.a.info("\u6682\u65e0\u968f\u673a\u64ad\u653e\u6b4c\u66f2")}),[o.id,we,e,r]),Pe=Object(p.useCallback)((function(){return"one"===J||"loop"===J?Le():"shuffle"===J?Se():void 0}),[J,Le,Se]),Ee=Object(p.useCallback)((function(){if(r.length>1){var t=r.findIndex((function(e){return e.id===o.id}));if(t===r.length-1)e.change_current_song_info(r[0]),y&&we();else{var n=r[t+1];e.change_current_song_info(n),y&&we()}}}),[o.id,we,y,e,r]),Be=Object(p.useCallback)((function(){return"one"===J||"loop"===J?Ee():"shuffle"===J?Se():void 0}),[J,Ee,Se]),Ae=Object(p.useCallback)((function(){q((function(e){var t=K.findIndex((function(t){return t===e}));return t++,K[t%3]}))}),[]);Object(p.useEffect)((function(){var t=function(t){t.ctrlKey&&"ArrowRight"===t.code&&Be(),t.ctrlKey&&"ArrowLeft"===t.code&&Pe(),"KeyP"===t.code&&e.change_is_play(),"KeyM"===t.code&&Ae()};return window.addEventListener("keyup",t),function(){window.removeEventListener("keyup",t)}}),[Be,Pe,e,Ae]),Object(p.useEffect)((function(){if($){var e=ke.current,t=document.querySelector(".songList-content .songList-item.active");if(e&&t){var n=e.getBoundingClientRect()||{},c=t.getBoundingClientRect()||{};(c.bottom<=n.top||c.top>=n.bottom)&&t.scrollIntoView({behavior:"smooth",block:"center"})}}}),[o.id,$]);var Ie=T(de,o.dt,ve,o.id),Te=Object(f.a)(Ie,1)[0];Object(p.useEffect)((function(){var e=document.querySelector(".lyric-content .lyric-item.active");e&&e.scrollIntoView({behavior:"smooth",block:"center"})}),[Te]),R(_e,(function(){ee(!1)})),R(ye,(function(){Q(!1)}));var Re=Object(p.useCallback)((function(){switch(J){case"loop":return"\u987a\u5e8f\u64ad\u653e";case"shuffle":return"\u968f\u673a\u64ad\u653e";case"one":return"\u5355\u66f2\u5faa\u73af";default:return null}}),[J]),Fe=Object(p.useCallback)((function(){r.length&&(e.clear_song_list(),b.a.success("\u5217\u8868\u6e05\u7a7a\u6210\u529f"))}),[e,r.length]),Me=Object(p.useCallback)((function(t,n){n.stopPropagation(),o.id===t&&r.length>1&&Ee(),e.del_song_list_item(t)}),[o.id,Ee,e,r.length]),Ue=Object(p.useCallback)((function(){var e=o.id;e&&A.a.homeApi.getSongUrl(e).then((function(t){if(200===t.data.code){var n,c,i=(null===(n=t.data)||void 0===n||null===(c=n.data[0])||void 0===c?void 0:c.url)||"";i?window.open(i):window.open("https://music.163.com/song/media/outer/url?id=".concat(e,".mp3"))}})).catch((function(){}))}),[o.id]),Ke=Object(p.useCallback)(Object(L.a)(Ue,5e3,{leading:!0,trailing:!1}),[o.id]),Ve=Object(p.useCallback)((function(e){var t=e.currentTarget.currentTime,n=+(1e3*t/o.dt).toFixed(3);n!==re&&(je(t),le(n))}),[o.dt,re]),We=Object(p.useCallback)((function(t){le(t);var n=t*o.dt/1e3;xe.current&&(xe.current.currentTime=n,y||e.change_is_play())}),[o.dt,y,e]),De=Object(p.useCallback)((function(e){switch(J){case"loop":Ee();break;case"shuffle":Se();break;case"one":we()}}),[J,we,Ee,Se]),Ge=Object(p.useCallback)(function(){var e=Object(d.a)(u.a.mark((function e(t){var n,c,i,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==(null===ge||void 0===ge?void 0:ge.type)){e.next=7;break}return e.next=3,A.a.homeApi.getSongUrl(o.id);case 3:return n=e.sent,c="",200===n.data.code&&(c=(null===(i=n.data)||void 0===i||null===(a=i.data[0])||void 0===a?void 0:a.url)||""),e.abrupt("return",pe({type:2,url:c}));case 7:b.a.destroy(),b.a.info("\u5f53\u524d\u6b4c\u66f2\u65e0\u6cd5\u64ad\u653e, 3s \u540e\u81ea\u52a8\u5207\u6362\u4e0b\u4e00\u9996"),Ce.current.id=setTimeout((function(){Be()}),3e3);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[o.id,Be,null===ge||void 0===ge?void 0:ge.type]);Object(p.useEffect)((function(){null===ge||void 0===ge||ge.url;var e=Ce.current.id;e&&window.clearTimeout(e)}),[null===ge||void 0===ge?void 0:ge.url]),Object(p.useEffect)((function(){o.id&&pe({type:1,url:"https://music.163.com/song/media/outer/url?id=".concat(o.id,".mp3")})}),[o.id]);var Je=Object(p.useCallback)((function(){y&&xe.current&&xe.current.play()}),[y]),qe=Object(p.useCallback)((function(t){t.id!==o.id&&(y||e.change_is_play(),e.change_current_song_info(t))}),[o.id,y,e]),He=Object(p.useCallback)((function(){o.id&&e.history.push("/discover/song/".concat(o.id))}),[o.id,e.history]);return Object(U.jsxs)("div",{ref:_e,className:E.a.PlayBar,style:{bottom:P||V?0:-46},onMouseEnter:function(){P||(clearTimeout(Ne.current.id),V||W(!0))},onMouseLeave:function(){P||(clearTimeout(Ne.current.id),Ne.current.id=setTimeout((function(){return W(!1)}),500))},children:[Object(U.jsxs)("div",{className:[E.a.container,"w980"].join(" "),children:[Object(U.jsxs)("div",{className:"playBtns",children:[Object(U.jsx)("div",{className:"prev",title:"\u4e0a\u4e00\u9996(Ctrl+\u2190)",onClick:Pe}),Object(U.jsx)("div",{className:y?"play":"stop",title:y?"\u6682\u505c(P)":"\u64ad\u653e(P)",onClick:function(){return e.change_is_play()}}),Object(U.jsx)("div",{className:"next",title:"\u4e0b\u4e00\u9996(Ctrl+\u2192)",onClick:Be})]}),Object(U.jsxs)("div",{className:"currentSongInfo",children:[Object(U.jsx)("img",{src:(null===o||void 0===o||null===(t=o.al)||void 0===t?void 0:t.picUrl)+"?param=35y35",alt:""}),Object(U.jsxs)("div",{className:"currentSongInfoRight",children:[Object(U.jsxs)("div",{className:"right-t",children:[Object(U.jsx)("div",{className:"songName ellipsis-1",onClick:He,children:o.name}),Object(U.jsx)("div",{className:"songAuthor ellipsis-1",children:Object(U.jsx)(M.a,{list:(null===o||void 0===o?void 0:o.ar)||[]})})]}),Object(U.jsxs)("div",{className:"right-b",children:[Object(U.jsx)("div",{className:"process-bar",children:Object(U.jsx)(l.a,{value:re,min:0,max:1,step:.005,tooltipVisible:!1,onChange:We})}),Object(U.jsxs)("div",{className:"time",children:[Object(U.jsxs)("span",{className:"play-time",children:[k()(re*o.dt).format("mm:ss")," "]}),Object(U.jsxs)("span",{className:"total-time",children:["/ ",k()(o.dt).format("mm:ss")]})]})]})]})]}),Object(U.jsxs)("div",{className:"leftBtns",children:[Object(U.jsx)(s.a,{title:"\u4e0b\u8f7d\u97f3\u4e50",children:Object(U.jsx)(v.a,{className:"icon",onClick:Ke})}),Object(U.jsx)(s.a,{title:"\u91cd\u65b0\u64ad\u653e",children:Object(U.jsx)(m.a,{className:"icon",onClick:we})})]}),Object(U.jsxs)("div",{className:"rightBtns",children:[Object(U.jsxs)("div",{className:"voice",ref:ye,children:[Object(U.jsx)("div",{className:"voice-bar-btn btn",onClick:function(){return Q(!z)}}),Object(U.jsx)(x.a,{mode:"scale",in:z,timeout:300,children:Object(U.jsx)("div",{className:"voice-bar",children:Object(U.jsx)("div",{style:{height:110},children:Object(U.jsx)(l.a,{min:0,max:1,step:.01,vertical:!0,value:ce,tipFormatter:function(e){var t;return null===(t=e&&100*e)||void 0===t?void 0:t.toFixed(0)},onChange:function(e){return ie(e)}})})})})]}),Object(U.jsx)(s.a,{title:"".concat(Re(),"(M)"),children:Object(U.jsx)("div",{className:"btn circle-mode ".concat(J),onClick:Ae})}),Object(U.jsx)("div",{className:"btn song-list",onClick:function(){return ee(!$)},children:Object(U.jsx)("div",{className:"songCount",children:(null===r||void 0===r?void 0:r.length)||0})})]})]}),Object(U.jsx)("audio",{id:"audio",ref:xe,onTimeUpdate:Ve,onEnded:De,onError:Ge,preload:"auto",onProgress:function(e){},onCanPlay:Je,src:null===ge||void 0===ge?void 0:ge.url}),Object(U.jsx)(x.a,{mode:"scale",in:$,timeout:300,children:Object(U.jsx)("div",{className:E.a.songListAndLyricWrapper,children:Object(U.jsxs)("div",{className:E.a.songListAndLyric,style:{background:"rgba(31, 31, 31, 0.5) url('//music.163.com/api/img/blur/".concat(null===o||void 0===o||null===(n=o.al)||void 0===n?void 0:n.pic_str,"') no-repeat center center/986px ")},children:[Object(U.jsxs)("div",{className:"songList",children:[Object(U.jsxs)("div",{className:"songList-title",children:[Object(U.jsxs)("div",{className:"songList-title-l",children:["\u64ad\u653e\u5217\u8868(",(null===r||void 0===r?void 0:r.length)||0,")"]}),Object(U.jsxs)("div",{className:"songList-title-r",title:"\u6e05\u9664\u64ad\u653e\u5217\u8868",onClick:Fe,children:[Object(U.jsx)(O.a,{className:"icon"})," \u6e05\u9664"]})]}),Object(U.jsx)("div",{className:"songList-content custom-scroll-bar",ref:ke,children:r.map((function(e){return Object(U.jsxs)("div",{className:"songList-item ".concat(o.id===e.id?"active":""),onClick:function(){return qe(e)},children:[Object(U.jsx)("div",{className:"redIcon",children:Object(U.jsx)(h.a,{className:"icon"})}),Object(U.jsx)("div",{className:"songList-item-name ellipsis-1",children:e.name}),Object(U.jsx)("div",{className:"btns",children:Object(U.jsx)(O.a,{title:"\u5220\u9664",className:"icon",onClick:function(t){return Me(e.id,t)}})}),Object(U.jsx)("div",{className:"songList-item-author ellipsis-1",children:N.a.getArtistStr(e.ar)}),Object(U.jsx)("div",{className:"songList-item-time",children:k()(e.dt).format("mm:ss")})]},e.id)}))})]}),Object(U.jsxs)("div",{className:"lyric",children:[Object(U.jsxs)("div",{className:"lyric-title ellipsis-1",children:[o.name,Object(U.jsx)(g.a,{title:"\u5173\u95ed",onClick:function(){return ee(!1)},className:"icon"})]}),Object(U.jsxs)("div",{className:"lyric-content custom-scroll-bar",children:[ve.length?ve.map((function(e,t){return Object(U.jsx)("div",{className:"lyric-item  ellipsis-1 ".concat(Te===t?"active":""),children:e.content},t)})):null,0===ve.length?Object(U.jsx)("div",{style:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(U.jsx)(i.a,{style:{color:"white"},description:"\u6682\u65e0\u6b4c\u8bcd\u4fe1\u606f",image:i.a.PRESENTED_IMAGE_SIMPLE})}):null]})]})]})})}),!$&&y&&(null===(c=ve[Te])||void 0===c?void 0:c.content)?Object(U.jsx)("div",{className:[E.a["lyric-show-box"],"ellipsis-1"].join(" "),children:null===(a=ve[Te])||void 0===a?void 0:a.content}):null,Object(U.jsx)("div",{className:E.a["bg-l"]}),Object(U.jsx)("div",{className:E.a.miniLock,children:Object(U.jsx)("div",{className:[E.a.btn,P?E.a.lock:E.a.unlock].join(" "),onClick:function(){return B(!P)}})}),Object(U.jsx)("div",{className:E.a["bg-r"]})]})};V.defaultProps={};t.default=Object(p.memo)(Object(_.connect)((function(e){return{songList:e.songList,currentSongInfo:e.currentSongInfo,playBarState:e.playBarState}}),(function(e){return{clear_song_list:function(){return e(Object(w.b)())},del_song_list_item:function(t){return e(Object(w.c)(t))},change_current_song_info:function(t){e(Object(S.a)(t))},change_is_play:function(){return e(Object(B.a)())},start_is_play:function(){return e(Object(B.b)())}}}))(Object(F.f)(V)))}}]);